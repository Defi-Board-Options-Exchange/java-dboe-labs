# **DBOE Labs (Java version)**

This lab empowers DBOE on various capabilities such as Options Listing on a daily basis, Analytical power as well a Trading Interface, all written in Java.

It would be a miss if we dont give credit to where it's due.

We would like to sincerely thank to the following entities or names who we think we have used their products in a very significant way.

1) Esper Tech at https://esper.espertech.com for their powerful "Complex Event Processing" engine.
One of the key developers shared with us that he has been using Esper since 2009 and strongly recommended us to use it

2) Spring Framework at https://spring.io. Yes, we are heavily Spring-driven apps in the way we code and the way we test.

**Below instructions are for those who want to connect to DBOE API and Smart Contract to do your own API trading**
# **End-to-end integration steps**

###### **Interacting with DBOE Relayer**

1. Download DBOE Order Book Configurations such as minimum order notional for LMT orders, maximum time in effect and etc.
https://dboe.exchange:8443/api/query/clobSpecs

2. Download the details of the price spread: how many levels, and the spread value for each level
https://dboe.exchange:8443/api/query/fixedSpreads

3. Download all Options instruments including its Order Book Smart Contract Address
https://dboe.exchange:8443/api/query/listInstrument?chain=Polygon 

4. Pull Order Book data from DBOE Relayer (can do via Smart Contract alternatively)
a) To pull Level 1 Order Book for the whole expiry: https://dboe.exchange:8443/api/query/optionChainMarket?chain=Polygon&underlying=ETH&expiry=20231125&collateralGroup=20%
b) To pull Order Book for one particular Option Series: https://dboe.exchange:8443/api/query/orderbook?chain=Polygon&instrId=E2100C1125

###### **Interacting with DBOE Smart Contract**

With DBOE Smart Contract addresses found in step 3 above (e.g. clearing_house or ob_address)

5. Granting Spending Limit (both USDT and Long & Short Option) to Clearing House in order to start trading
a) Usual approve() on USDT
b) For Options, Users can either do one by one as regular ERC20 tokens or call function enableTrading(bytes32 _und, uint256 _exp) on the clearing house smart contract. Two input parameters are underlying and expiry.


6. To submit prices, there are two methods, one for MKT order and one for LMT orders
a) LMT order: toPrice(bytes32 optionSeries, bool buySell, uint256 amount, uint256 priceLevel, uint256 validPeriodSecs). Please note: parameter priceLevel starting with 1 as the lowest level rather than 0
b) MKT order: 
- toTrade(bytes32 optionSeries, bool buySell, uint256 notional)
- toTradeByQty(bytes32 optionSeries, bool buySell, uint256 amount)

7. To cancel order: toCancel(bytes32 optionSeries, bool buySell, uint256 priceLevel, uint256 orderSubmissionTime)

8. Pull order book from DBOE Order Book Smart Contract (address with property name ob_address): obDepth(bytes32 optionSeries, bool buySell)

9. Users can try to refresh the reference prices. Refer to FAQ no. 1 for more information
a) For a particular Option: refreshRefPx(bytes32 optionSeries)
b) For for the whole expiry: refreshRefs(bytes32 _und, uint256 _expiry)

###### **Sample Codes**

1. Github: https://github.com/Defi-Board-Options-Exchange/java-dboe-labs 

2. Java-based smart contract (auto-generated by web3j): https://github.com/Defi-Board-Options-Exchange/java-dboe-labs/tree/master/dboe-web3j-common/src/main/java/com/ngontro86/dboe/web3j 

3. POC Market making Program: https://github.com/Defi-Board-Options-Exchange/java-dboe-labs/tree/master/dboe-market-making 
a) Pull live prices from external venues
b) Calculate greek risk given a list of holder addresses
c) Hedging out the risk using futures on an external venue (e.g. Binance)
d) Submit two sided quotes on DBOE market
 